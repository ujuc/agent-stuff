---
name: generate-claude-md
description: CLAUDE.md 파일을 가이드 원칙에 따라 생성한다. 프로젝트 분석, 인터뷰, 생성, 검증의 4단계 워크플로우를 수행한다.
model: opus
disable-model-invocation: true
---

# CLAUDE.md 생성 스킬

$ARGUMENTS 가 주어지면 해당 프로젝트 경로를 대상으로 한다. 없으면 현재 작업 디렉토리를 대상으로 한다.

아래 4단계를 순서대로 수행한다.

---

## 1단계: 프로젝트 분석

대상 디렉토리에서 다음을 자동 탐지한다:

- 패키지 매니저 (package.json, Cargo.toml, pyproject.toml, go.mod 등)
- 빌드 시스템 및 빌드 명령
- 테스트 프레임워크 및 테스트 실행 명령
- 린터/포매터 설정 (.eslintrc, .prettierrc, biome.json, ruff.toml 등)
- 모노레포 구조 여부 (workspaces, packages/, apps/ 등)
- CI/CD 설정 (.github/workflows, .gitlab-ci.yml 등)
- 기존 CLAUDE.md, AGENTS.md, .cursorrules 등의 존재 여부

탐지 결과를 간략히 정리하여 사용자에게 보여준다.

---

## 2단계: 인터뷰

자동으로 알 수 없는 항목에 대해 사용자에게 질문한다. WHAT/WHY/HOW 프레임워크를 따른다.

질문은 다음 범위 내에서 필요한 것만 한다:

**WHY (자동 탐지 불가)**:
- 이 프로젝트의 목적/역할은 무엇인가?

**WHAT (자동 탐지로 부족한 부분만)**:
- 모노레포인 경우 각 패키지/앱의 역할
- 외부 서비스 의존성 (DB, 메시지 큐, 외부 API 등)

**HOW (자동 탐지로 부족한 부분만)**:
- 특별한 작업 규칙이나 워크플로우가 있는가?
- 브랜치 전략, PR 규약, 커밋 메시지 규칙이 있는가?
- 환경 설정에 필요한 특이사항이 있는가?

질문은 한 번에 모아서 한다. 자동 탐지로 이미 파악한 내용은 질문하지 않는다.

---

## 3단계: 생성

두 가지를 생성한다:

### A. 루트 CLAUDE.md

다음 원칙을 엄격히 적용한다:

- 모든 세션, 모든 작업에 적용되는 보편적 내용만 포함한다
- 목표 줄 수: 100줄 이하. 절대 300줄을 넘기지 않는다
- 코드 스타일 규칙을 포함하지 않는다 (린터/포매터에 위임)
- 코드 스니펫을 직접 포함하지 않는다 (file:line 참조 사용)
- 점진적 공개를 위한 agent_docs/ 참조를 포함한다

구조:

~~~markdown
# 프로젝트 개요
(WHY: 1-2줄로 프로젝트 목적)

# 기술 스택
(WHAT: 핵심 기술만 나열)

# 개발 명령
(HOW: 빌드, 테스트, 린트 명령)

# 작업 규칙
(HOW: 브랜치, 커밋, PR 등 보편적 규칙)

# 참조 문서
작업에 관련된 문서가 있으면 읽고 시작한다:
- agent_docs/building_the_project.md: 빌드 및 배포 상세
- agent_docs/architecture.md: 서비스 아키텍처 및 통신 패턴
- agent_docs/testing.md: 테스트 전략 및 실행 방법
(필요한 문서만 포함)
~~~

### B. agent_docs/ 분리 문서

CLAUDE.md에서 제외된 상세 내용을 별도 문서로 생성한다. 다음 중 프로젝트에 해당하는 것만 생성한다:

- `agent_docs/architecture.md`: 서비스 구조, 통신 패턴, 데이터 흐름
- `agent_docs/building_the_project.md`: 상세 빌드/배포 절차
- `agent_docs/testing.md`: 테스트 전략, 테스트 데이터 설정
- `agent_docs/database.md`: 스키마 구조, 마이그레이션 방법
- `agent_docs/conventions.md`: 코드 규약, 네이밍 규칙 (린터로 강제할 수 없는 것만)

각 분리 문서도 간결하게 작성하며, 코드 스니펫 대신 file:line 참조를 사용한다.

---

## 4단계: 검증

생성된 CLAUDE.md에 대해 다음 체크리스트를 줄 단위로 적용한다:

1. **보편성**: 이 줄은 모든 작업에 적용되는가? -> 아니면 agent_docs/로 이동
2. **필수성**: 이 줄이 없으면 Claude가 실수하는가? -> 아니면 삭제
3. **중복**: 코드를 읽으면 알 수 있는 내용인가? -> 맞으면 삭제
4. **린터 역할**: 코드 스타일 규칙인가? -> 맞으면 삭제하고 린터/Hook으로 대체 권장
5. **줄 수**: 100줄 이하인가? -> 초과하면 추가 정제 필요
6. **지시사항 수**: 개별 지시사항이 50개 이하인가? -> 초과하면 통합 또는 삭제

검증 결과를 사용자에게 보고한다. 탈락 항목이 있으면 해당 줄과 사유를 함께 표시하고, 정제된 최종본을 제시한다.

---

## 참고 원칙

- Claude Code 시스템 프롬프트가 이미 ~50개 지시사항을 포함한다. CLAUDE.md의 지시사항이 추가되면 전체 예산을 빠르게 소진한다.
- Claude Code는 CLAUDE.md를 "현재 작업과 관련 없으면 무시하라"는 리마인더와 함께 주입한다. 보편적이지 않은 내용이 많을수록 전체가 무시될 확률이 높아진다.
- 상위 레벨(CLAUDE.md)의 오류는 하위(계획 -> 코드)로 기하급수적으로 증폭된다.
- LLM은 인컨텍스트 학습자이므로, 기존 코드 패턴을 검색하면 스타일을 자연스럽게 따라간다.
